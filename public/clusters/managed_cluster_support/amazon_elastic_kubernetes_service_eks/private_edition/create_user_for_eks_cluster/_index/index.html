
<!doctype html>
<html lang="en-us">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1, user-scalable=yes">
  <title>Create a User for Amazon EKS</title>
  <script src="//bower_components/webcomponentsjs/webcomponents-lite.js"></script>
  <link rel="import" href="//bower_components/iron-icons/iron-icons.html">
  <link rel="import" href="//bower_components/paper-drawer-panel/paper-drawer-panel.html">
  <link rel="import" href="//bower_components/paper-icon-button/paper-icon-button.html">
  <link rel="import" href="//bower_components/paper-toolbar/paper-toolbar.html">
  <link rel="import" href="//bower_components/paper-scroll-header-panel/paper-scroll-header-panel.html">
  <link rel="import" href="//bower_components/paper-fab/paper-fab.html">
  <link rel="import" href="//bower_components/paper-item/paper-item.html">
  <link rel="import" href="//bower_components/paper-menu/paper-menu.html">
  <link rel="import" href="//bower_components/iron-image/iron-image.html">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/default.min.css">
  <style is="custom-style">
    body {
      font-family: 'Roboto', sans-serif;
    }
    .nav {
      border-right: 1px solid #ccc;
    }
    
    paper-scroll-header-panel {
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      background-color: var(--paper-grey-200, #eee);
       
      --paper-scroll-header-panel-full-header: {
        background-image: url(//images/cover.png);
      };
       
      --paper-scroll-header-panel-condensed-header: {
        background-image: url(//images/cover.png);
      };
    }
    
    paper-toolbar {
       
      height: 256px;
      background-color: transparent;
    }
    .profile{
      width: 100%;
      padding-bottom: 20px;
    }
    .photo{
      margin: 20px;
      display: inline-block;
      height: 64px; width: 64px;
      border-radius: 50%;
    }
    .article{
      border: 1px solid #bebebe;
      padding: 16px;
      margin: 16px;
      border-radius: 5px;
      background-color: #fff;
    }
    .title{
      font-size: 22px;
      padding: 8px 0 16px;
    }
    .description{
      font-size: 16px;
      padding-bottom: 8px;
    }
    .author{
      font-size: 16px;
      padding-left: 20px;
      color: white;
    }
    .design{
      font-size: 14px;
    }
    .copyright{
      font-size: 16px;
    }
    paper-menu a {
      text-decoration: none;
      color: #212121;
    }
  </style>

</head>
<body>
  <paper-drawer-panel id="drawerPanel" responsive-width="1280px">
    <div class="nav scroll" drawer>
    
      <iron-image class="profile" sizing="cover" src="//images/profile.png">
    
        
          <iron-image class="photo" sizing="cover" src="//images/photo.png"></iron-image>
        
          <div class="author">Your Name</div>
      </iron-image>
      <paper-menu>
        <a href="/"><paper-item>
          <iron-icon icon="home"></iron-icon>　<div class="flex">Home</div>
          <iron-icon icon="chevron-right"></iron-icon>
        </paper-item></a>
        <a href="//categories/"><paper-item>
          <iron-icon icon="drafts"></iron-icon>　<div class="flex">Categories</div>
          <iron-icon icon="chevron-right"></iron-icon>
        </paper-item></a>
        <a href="//tags/"><paper-item>
          <iron-icon icon="loyalty"></iron-icon>　<div class="flex">Tags</div>
          <iron-icon icon="chevron-right"></iron-icon>
        </paper-item></a>
      </paper-menu>
    </div>

    <paper-scroll-header-panel main condenses header-height="256" condensed-header-height="64">

      <paper-toolbar>

        <paper-icon-button icon="menu" paper-drawer-toggle></paper-icon-button>
        <div class="bottom title">Your Site Title</div>
        <div class="flex"></div>
        
          <a href="https://www.facebook.com/Your%20facebook%20Name"><paper-icon-button src="//images/facebook-dreamstale25.png"></paper-icon-button></a>
        
        
          <a href="https://twitter.com/Your%20Twitter%20Name"><paper-icon-button src="//images/twitter-dreamstale71.png"></paper-icon-button></a>
        
        
          <a href="https://google.com/+Your%20Google&#43;%20Name"><paper-icon-button src="//images/google+-dreamstale37.png"></paper-icon-button></a>
        
        
          <a href="https://www.linkedin.com/in/Your%20linkedin%20Name"><paper-icon-button src="//images/linkedin-dreamstale45.png"></paper-icon-button></a>
        
        
          <a href="https://github.com/Your%20Github%20Name"><paper-icon-button src="//images/github2-dreamstale35.png"></paper-icon-button></a>
        
          <a href="//index.xml"><paper-icon-button src="//images/feed-dreamstale27.png"></paper-icon-button></a>
      
      </paper-toolbar>



<div class="content">

  <div class="article">
    <div class="title">Create a User for Amazon EKS</div>
     
    <div class="description"><p>For Nirmata Private Edition, you will need to create an AWS User with necessary permissions to provision EC2 worker nodes as well as create EKS control plane. For the user, you will use the user access id and secret key to configure AWS Cloud Provider in Nirmata.</p>

<p>First, you need create a policy with specific permissions for the User. login to the AWS Management Console and select IAM Services. Click on Policies under AWS IAM screen and choose &ldquo;Create Policy&rdquo; button.</p>

<p><img src="/images/Select-Policy-EKS-User.png" alt="image" /></p>

<p>Under Policy, choose JSON, and copy and paste the permissions as highlighted below -</p>

<pre><code class="language-json">{
    &quot;Version&quot;: &quot;2012-10-17&quot;,
    &quot;Statement&quot;: [
        {
            &quot;Sid&quot;: &quot;VisualEditor0&quot;,
            &quot;Effect&quot;: &quot;Allow&quot;,
            &quot;Action&quot;: [
                &quot;ec2:TerminateInstances&quot;,
                &quot;ec2:StartInstances&quot;,
                &quot;ec2:StopInstances&quot;
            ],
            &quot;Resource&quot;: &quot;arn:aws:ec2:*:094919933512:instance/*&quot;,
            &quot;Condition&quot;: {
                &quot;StringEquals&quot;: {
                    &quot;ec2:ResourceTag/com.nirmata.createdBy&quot;: &quot;nirmata&quot;
                }
            }
        },
        {
            &quot;Sid&quot;: &quot;VisualEditor1&quot;,
            &quot;Effect&quot;: &quot;Allow&quot;,
            &quot;Action&quot;: [
                &quot;iam:GetPolicyVersion&quot;,
                &quot;autoscaling:Describe*&quot;,
                &quot;iam:ListInstanceProfilesForRole&quot;,
                &quot;iam:PassRole&quot;,
                &quot;iam:SimulateCustomPolicy&quot;,
                &quot;iam:ListAttachedRolePolicies&quot;,
                &quot;iam:ListAttachedUserPolicies&quot;,
                &quot;iam:ListAttachedGroupPolicies&quot;,
                &quot;iam:ListRolePolicies&quot;,
                &quot;iam:ListPolicies&quot;,
                &quot;iam:GetRole&quot;,
                &quot;iam:GetPolicy&quot;,
                &quot;iam:ListGroupPolicies&quot;,
                &quot;ec2:CreateTags&quot;,
                &quot;iam:ListRoles&quot;,
                &quot;ec2:RunInstances&quot;,
                &quot;iam:ListUserPolicies&quot;,
                &quot;iam:ListInstanceProfiles&quot;,
                &quot;ec2:Describe*&quot;,
                &quot;iam:ListPolicyVersions&quot;,
                &quot;iam:GetUserPolicy&quot;,
                &quot;iam:ListGroupsForUser&quot;,
                &quot;iam:ListUsers&quot;,
                &quot;iam:GetGroupPolicy&quot;,
                &quot;iam:GetUser&quot;,
                &quot;iam:GetRolePolicy&quot;,
                &quot;iam:GenerateCredentialReport&quot;,
                &quot;iam:GenerateServiceLastAccessedDetails&quot;,
                &quot;iam:Get*&quot;,
                &quot;iam:List*&quot;,
                &quot;iam:SimulateCustomPolicy&quot;,
                &quot;iam:SimulatePrincipalPolicy&quot;,
                &quot;iam:GetPolicyVersion&quot;,
                &quot;iam:SimulateCustomPolicy&quot;,
                &quot;iam:GenerateCredentialReport&quot;,
                &quot;iam:GenerateServiceLastAccessedDetails&quot;,
                &quot;iam:Get*&quot;,
                &quot;iam:List*&quot;,
                &quot;iam:SimulateCustomPolicy&quot;,
                &quot;iam:SimulatePrincipalPolicy&quot;,
                &quot;iam:CreateRole&quot;,
                &quot;iam:DeleteRole&quot;,
                &quot;iam:AttachRolePolicy&quot;,
                &quot;iam:DetachRolePolicy&quot;,
                &quot;iam:CreateInstanceProfile&quot;,
                &quot;iam:DeleteInstanceProfile&quot;,
                &quot;iam:AddRoleToInstanceProfile&quot;,
                &quot;iam:RemoveRoleFromInstanceProfile&quot;
            ],
            &quot;Resource&quot;: &quot;*&quot;
        },
        {
            &quot;Sid&quot;: &quot;VisualEditor2&quot;,
            &quot;Effect&quot;: &quot;Allow&quot;,
            &quot;Action&quot;: [
                &quot;cloudformation:CreateStack&quot;,
                &quot;cloudformation:DeleteStack&quot;,
                &quot;cloudformation:CreateChangeSet&quot;,
                &quot;cloudformation:UpdateStack&quot;,
                &quot;cloudformation:ExecuteChangeSet&quot;,
                &quot;cloudformation:Describe*&quot;,
                &quot;cloudformation:EstimateTemplateCost&quot;,
                &quot;cloudformation:Get*&quot;,
                &quot;cloudformation:List*&quot;,
                &quot;cloudformation:ValidateTemplate&quot;,
                &quot;cloudformation:DetectStackDrift&quot;,
                &quot;cloudformation:DetectStackResourceDrift&quot;
            ],
            &quot;Resource&quot;: [
                &quot;*&quot;
            ]
        },
        {
            &quot;Sid&quot;: &quot;VisualEditor3&quot;,
            &quot;Effect&quot;: &quot;Allow&quot;,
            &quot;Action&quot;: &quot;eks:*&quot;,
            &quot;Resource&quot;: &quot;*&quot;
        }
    ]
}
</code></pre>

<p>Click &ldquo;Review Policy&rdquo; and then save the policy.</p>

<p>Now, you can create a User required for EC2 and EKS Cluster management in Nirmata that will use this Policy. For that, login to the AWS Management Console and select IAM Services.</p>

<p>Select Users and then click on the button to Add a User.</p>

<p><img src="/images/Add-User-EKS-PE.png" alt="image" /></p>

<p>Select programmatic access and then select &ldquo;Next:Permission&rdquo; button.</p>

<p><img src="/images/User-EKS-prog-acccess.png" alt="image" /></p>

<p>Choose &ldquo;Attach existing policies directly&rdquo; and select the policy you created above.</p>

<p><img src="/images/eks_add_user_select_policy.png" alt="image" /></p>

<p>Also add couple of AWS Managed Policies as well -</p>

<p>AmazonEC2FullAccess
AmazonEC2ContainerRegistryReadOnly</p>

<p><img src="/images/permissions.png" alt="image" /></p>

<p>Now click on &ldquo;Security Credentials&rdquo; tab on the User menu and click on &ldquo;Create Access Key&rdquo;. You can download the Access Key Id and secret key. You can add the Access Key ID and Nirmata</p>

<p>In Nirmata, you will use this role in the EKS ARN role field as shown below.</p>

<p><img src="/images/AWS-Cloud-Provider-EKS.png" alt="image" /></p>
</div>
    <div class="tags">
      1 Jan 0001
       
    </div>
    
      <div id="disqus_thread"></div>
<script type="text/javascript">
     
    var disqus_shortname = 'Your Disqus Name';
    
     
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
    
  </div>

</div>

<paper-item>
  
    <a href="/hostgroups/openstack_host_groups/create_openstack_host_group/_index/"><paper-fab icon="chevron-left"><a></a></paper-fab></a>
  
    <div class="flex"></div>
  
    <a href="/hostgroups/vmware_vsphere_host_group/create_a_vsphere_template/_index/"><paper-fab icon="chevron-right"></paper-fab></a>
  
</paper-item>

      <paper-item>
        <div class="copyright">© 2015 Copyright Text</div>
        <div class="flex"></div>
        <div class="design">Design <a href="http://pdevty.github.io/blog/">pdevty</a></div>
      </paper-item>
    </paper-scroll-header-panel>
  </paper-drawer-panel>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'Your Analytics User Id', 'auto');
    ga('send', 'pageview');
  </script>
  
</body>
</html>
